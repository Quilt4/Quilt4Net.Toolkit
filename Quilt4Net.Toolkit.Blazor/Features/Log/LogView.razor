@using Quilt4Net.Toolkit.Features.ApplicationInsights
<RadzenRow Style="margin-bottom: 6px;" Visible="ShowRangeSelector">
    <RadzenColumn>
        <RadzenStack Orientation="Orientation.Vertical" Gap="0">
            <RadzenText TextStyle="TextStyle.Caption" Text="Range"/>
            <LogRangeView OnSelected="OnRangeSelected"/>
        </RadzenStack>
    </RadzenColumn>
</RadzenRow>

<RadzenTabs Change="StateHasChanged">
    <Tabs>
        <RadzenTabsItem Text="Search">
            <LogSearchView Range="@RangeToUse" Context="Context" />
        </RadzenTabsItem>
        <RadzenTabsItem Text="Summary">
            <LogSummaryListView Range="@RangeToUse" Context="Context" />
        </RadzenTabsItem>
        <RadzenTabsItem Text="Measure">
            <LogMeasureView Range="@RangeToUse" Context="Context" />
        </RadzenTabsItem>
        <RadzenTabsItem Text="Count">
            <LogCountView Range="@RangeToUse" Context="Context" />
        </RadzenTabsItem>
        <RadzenTabsItem Text="Trigger" Visible="@(Context == null)">
            <LogTriggerView Context="Context" />
        </RadzenTabsItem>
    </Tabs>
</RadzenTabs>

@code {
    private LogRangeView.TimeRangeOption _range;

    [Parameter]
    public bool ShowRangeSelector { get; set; } = true;

    [Parameter]
    public TimeSpan? Range { get; set; }

    [Parameter]
    public IApplicationInsightsContext Context { get; set; }

    private TimeSpan RangeToUse => ShowRangeSelector ? _range : (Range ?? TimeSpan.Zero);

    private void OnRangeSelected(LogRangeView.TimeRangeOption range)
    {
        _range = range;
        StateHasChanged();
    }
}
